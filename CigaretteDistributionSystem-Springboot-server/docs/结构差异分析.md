# ç»“æ„å·®å¼‚åˆ†ææŠ¥å‘Š

## ğŸ“Š é¢„æœŸç»“æ„ vs å®é™…ç»“æ„å¯¹æ¯”

### âŒ ä¸»è¦å·®å¼‚

#### 1. **Mapperä½ç½®ä¸ä¸€è‡´**
- **é¢„æœŸ**: `infrastructure/persistence/mapper/`
- **å®é™…**: `org.example.mapper/`ï¼ˆæ ¹ç›®å½•ï¼‰
- **å½±å“**: Mapperåº”è¯¥å±äºåŸºç¡€è®¾æ–½å±‚ï¼Œåº”è¯¥åœ¨persistenceä¸‹

#### 2. **DTOä½ç½®ä¸ä¸€è‡´**
- **é¢„æœŸ**: 
  - `application/dto/` - åº”ç”¨å±‚DTO
  - `shared/dto/` - å…±äº«DTOï¼ˆè·¨å±‚ä½¿ç”¨ï¼‰
- **å®é™…**: `org.example.dto/`ï¼ˆæ ¹ç›®å½•ï¼‰
- **å½±å“**: DTOåº”è¯¥æŒ‰ç”¨é€”åˆ†ç±»åˆ°ä¸åŒå±‚

#### 3. **ç®—æ³•é€‚é…å™¨ä½ç½®ä¸ä¸€è‡´**
- **é¢„æœŸ**: `infrastructure/algorithm/`ï¼ˆç®—æ³•é€‚é…å™¨ï¼ŒSpringé€‚é…å™¨ï¼‰
- **å®é™…**: `org.example.algorithm/`ï¼ˆæ ¹ç›®å½•ï¼‰
- **å½±å“**: ç®—æ³•é€‚é…å™¨åº”è¯¥å±äºåŸºç¡€è®¾æ–½å±‚

#### 4. **é—ç•™ç›®å½•æœªæ¸…ç†**
- **å®é™…å­˜åœ¨ä½†ä¸åº”å­˜åœ¨**:
  - `dao/` - å·²è¿ç§»åˆ°Repositoryï¼Œä½†ç›®å½•ä»å­˜åœ¨
  - `entity/` - å·²è¿ç§»åˆ°`infrastructure/persistence/po/`ï¼Œä½†ç›®å½•ä»å­˜åœ¨
  - `service/` - å·²è¿ç§»åˆ°`application/service/`ï¼Œä½†éƒ¨åˆ†æ–‡ä»¶ä»åœ¨æ—§ä½ç½®
  - `domain/service/impl/` - ç©ºç›®å½•ï¼Œåº”è¯¥åˆ é™¤
  - `domain/rule/` - ç©ºç›®å½•ï¼Œåº”è¯¥åˆ é™¤

#### 5. **å…±äº«å±‚DTOç¼ºå¤±**
- **é¢„æœŸ**: `shared/dto/RegionCustomerRecord.java`
- **å®é™…**: `dto/RegionCustomerRecord.java`
- **å½±å“**: å…±äº«DTOåº”è¯¥åœ¨sharedå±‚

#### 6. **åº”ç”¨å±‚è½¬æ¢å™¨ä½ç½®**
- **é¢„æœŸ**: `application/converter/DistributionDataConverter.java`
- **å®é™…**: `shared/util/DistributionDataConverter.java`
- **å½±å“**: è½¬æ¢å™¨å±äºåº”ç”¨å±‚èŒè´£ï¼Œåº”è¯¥åœ¨applicationä¸‹

## ğŸ” è¯¦ç»†å·®å¼‚åˆ—è¡¨

### ç›®å½•ç»“æ„å·®å¼‚

| é¢„æœŸä½ç½® | å®é™…ä½ç½® | çŠ¶æ€ | è¯´æ˜ |
|---------|---------|------|------|
| `infrastructure/persistence/mapper/` | `org.example.mapper/` | âŒ ä¸ä¸€è‡´ | Mapperåº”è¯¥åœ¨persistenceä¸‹ |
| `infrastructure/persistence/mapper/*.xml` | `src/main/resources/mapper/` | âœ… æ­£ç¡® | XMLæ–‡ä»¶ä½ç½®æ­£ç¡® |
| `application/dto/` | `org.example.dto/` | âŒ ä¸ä¸€è‡´ | åº”ç”¨å±‚DTOåº”è¯¥åœ¨applicationä¸‹ |
| `shared/dto/` | `org.example.dto/` | âŒ ä¸ä¸€è‡´ | å…±äº«DTOåº”è¯¥åœ¨sharedä¸‹ |
| `infrastructure/algorithm/` | `org.example.algorithm/` | âŒ ä¸ä¸€è‡´ | ç®—æ³•é€‚é…å™¨åº”è¯¥åœ¨infrastructureä¸‹ |
| `application/converter/` | `shared/util/` | âŒ ä¸ä¸€è‡´ | è½¬æ¢å™¨åº”è¯¥åœ¨applicationä¸‹ |
| `dao/` | `dao/` | âŒ åº”åˆ é™¤ | å·²è¿ç§»åˆ°Repository |
| `entity/` | `entity/` | âŒ åº”åˆ é™¤ | å·²è¿ç§»åˆ°PO |
| `service/` | `service/` | âš ï¸ éƒ¨åˆ†é—ç•™ | éƒ¨åˆ†æ–‡ä»¶ä»åœ¨æ—§ä½ç½® |
| `domain/service/impl/` | `domain/service/impl/` | âŒ åº”åˆ é™¤ | ç©ºç›®å½• |
| `domain/rule/` | `domain/rule/` | âŒ åº”åˆ é™¤ | ç©ºç›®å½• |

### æ–‡ä»¶åˆ†ç±»å·®å¼‚

#### Mapperæ–‡ä»¶ï¼ˆ7ä¸ªï¼‰
- **é¢„æœŸ**: `infrastructure/persistence/mapper/`
- **å®é™…**: `org.example.mapper/`
- **æ–‡ä»¶åˆ—è¡¨**:
  - BaseCustomerInfoMapper.java
  - CigaretteDistributionInfoMapper.java
  - CigaretteDistributionPredictionMapper.java
  - CigaretteDistributionPredictionPriceMapper.java
  - RegionCustomerStatisticsMapper.java
  - IntegrityGroupMappingMapper.java
  - TemporaryCustomerTableMapper.java

#### DTOæ–‡ä»¶ï¼ˆ18ä¸ªï¼‰
- **é¢„æœŸ**: 
  - åº”ç”¨å±‚DTO â†’ `application/dto/`
  - å…±äº«DTO â†’ `shared/dto/`
- **å®é™…**: `org.example.dto/`
- **éœ€è¦åˆ†ç±»**:
  - åº”ç”¨å±‚DTOï¼ˆå¦‚GenerateDistributionPlanRequestDtoç­‰ï¼‰
  - å…±äº«DTOï¼ˆå¦‚RegionCustomerRecordï¼‰

#### ç®—æ³•é€‚é…å™¨ï¼ˆ6ä¸ªï¼‰
- **é¢„æœŸ**: `infrastructure/algorithm/`
- **å®é™…**: `org.example.algorithm/`
- **æ–‡ä»¶åˆ—è¡¨**:
  - SingleLevelDistributionAlgorithm.java
  - ColumnWiseAdjustmentAlgorithm.java
  - GroupSplittingDistributionAlgorithm.java
  - impl/DefaultSingleLevelDistributionAlgorithm.java
  - impl/DefaultColumnWiseAdjustmentAlgorithm.java
  - impl/DefaultGroupSplittingDistributionAlgorithm.java

## ğŸ¯ éœ€è¦è°ƒæ•´çš„å†…å®¹

### é«˜ä¼˜å…ˆçº§ï¼ˆå½±å“æ¶æ„æ¸…æ™°åº¦ï¼‰

1. **Mapperè¿ç§»åˆ°infrastructure/persistence/mapper/**
   - ç§»åŠ¨7ä¸ªMapperæ¥å£æ–‡ä»¶
   - æ›´æ–°æ‰€æœ‰importå¼•ç”¨
   - æ›´æ–°@MapperScané…ç½®

2. **DTOåˆ†ç±»è¿ç§»**
   - åº”ç”¨å±‚DTO â†’ `application/dto/`
   - å…±äº«DTO â†’ `shared/dto/`
   - æ›´æ–°æ‰€æœ‰importå¼•ç”¨

3. **ç®—æ³•é€‚é…å™¨è¿ç§»åˆ°infrastructure/algorithm/**
   - ç§»åŠ¨6ä¸ªç®—æ³•é€‚é…å™¨æ–‡ä»¶
   - æ›´æ–°æ‰€æœ‰importå¼•ç”¨

### ä¸­ä¼˜å…ˆçº§ï¼ˆæ¸…ç†å·¥ä½œï¼‰

4. **åˆ é™¤é—ç•™ç›®å½•**
   - åˆ é™¤ç©ºçš„`domain/service/impl/`
   - åˆ é™¤ç©ºçš„`domain/rule/`
   - æ£€æŸ¥å¹¶æ¸…ç†`dao/`ã€`entity/`ã€`service/`é—ç•™æ–‡ä»¶

5. **è½¬æ¢å™¨è¿ç§»**
   - `DistributionDataConverter` â†’ `application/converter/`
   - æ›´æ–°importå¼•ç”¨

## ğŸ“ è°ƒæ•´å»ºè®®

### æ–¹æ¡ˆ1ï¼šå®Œæ•´è¿ç§»ï¼ˆæ¨èï¼‰
æŒ‰ç…§é¢„æœŸç»“æ„å®Œæ•´è¿ç§»æ‰€æœ‰æ–‡ä»¶ï¼Œç¡®ä¿æ¶æ„å®Œå…¨ç¬¦åˆDDDåˆ†å±‚åŸåˆ™ã€‚

### æ–¹æ¡ˆ2ï¼šä¿æŒç°çŠ¶ï¼ˆå®ç”¨ï¼‰
å¦‚æœå½“å‰ç»“æ„å·²ç»ç¨³å®šè¿è¡Œï¼Œå¯ä»¥ä¿æŒç°çŠ¶ï¼Œä½†éœ€è¦æ›´æ–°æ–‡æ¡£è¯´æ˜å®é™…ç»“æ„ã€‚

### æ–¹æ¡ˆ3ï¼šæ¸è¿›å¼è¿ç§»
åˆ†é˜¶æ®µè¿ç§»ï¼Œæ¯æ¬¡è¿ç§»ä¸€ä¸ªæ¨¡å—ï¼Œç¡®ä¿ç¼–è¯‘å’Œæµ‹è¯•é€šè¿‡ã€‚

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Mapper XMLæ–‡ä»¶ä½ç½®**
   - XMLæ–‡ä»¶åœ¨`src/main/resources/mapper/`æ˜¯æ­£ç¡®çš„
   - åªéœ€è¦è¿ç§»Javaæ¥å£æ–‡ä»¶

2. **@MapperScané…ç½®**
   - éœ€è¦æ›´æ–°`@MapperScan`æŒ‡å‘æ–°çš„åŒ…è·¯å¾„

3. **ä¾èµ–å…³ç³»**
   - è¿ç§»åéœ€è¦æ£€æŸ¥æ‰€æœ‰importå¼•ç”¨
   - ç¡®ä¿ä¾èµ–æ–¹å‘ç¬¦åˆDDDåŸåˆ™

4. **æµ‹è¯•éªŒè¯**
   - æ¯æ¬¡è¿ç§»åéœ€è¦è¿è¡Œå®Œæ•´æµ‹è¯•
   - ç¡®ä¿åŠŸèƒ½æ­£å¸¸

